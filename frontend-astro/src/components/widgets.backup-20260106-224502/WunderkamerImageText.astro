---
interface Props {
  block: any;
  locale: string;
  getImageUrl: (id: string) => string;
  setAttr: (opts: any) => string;
}

const { block, locale, getImageUrl, setAttr } = Astro.props;

// Get localized text values
const getLocalizedField = (block: any, fieldName: string) => {
  const localizedFieldName = `${fieldName}_${locale}`;
  return block[localizedFieldName] || block[fieldName] || '';
};

const heading = getLocalizedField(block, 'heading');
const content = getLocalizedField(block, 'content');
const buttonText = getLocalizedField(block, 'button_text');
---

<section 
  class="wunderkamer-image-text-section"
  data-directus={setAttr({ collection: 'blocks', item: block.id, mode: 'drawer' })}
>
  <style>
    .wunderkamer-image-text-section {
      position: relative;
      width: 100%;
      min-height: 650px;
      background: white;
      overflow: hidden;
      font-family: 'Neue Haas Grotesk Display Pro', sans-serif;
      padding: 45px 0;
    }
    
    .wunderkamer-container {
      position: relative;
      max-width: 1440px;
      height: 600px;
      margin: 0 auto;
    }
    
    /* Left Image */
    .wunderkamer-image {
      position: absolute;
      left: 80px;
      top: 45px;
      width: 620px;
      height: 543px;
      border-radius: 10px;
      overflow: hidden;
      cursor: pointer;
      transition: opacity 0.3s ease;
    }
    
    .wunderkamer-image:hover {
      opacity: 0.95;
    }
    
    .wunderkamer-image img {
      position: absolute;
      height: 103.3%;
      left: -12.41%;
      max-width: none;
      top: -2.98%;
      width: 135.6%;
      object-fit: cover;
    }
    
    /* Right Text Content */
    .wunderkamer-text-content {
      position: absolute;
      left: 740px;
      top: 45px;
      width: 616px;
      height: auto;
      display: flex;
      flex-direction: column;
    }
    
    .wunderkamer-heading {
      font-family: 'Neue Haas Grotesk Display Pro', sans-serif;
      font-weight: 500;
      font-size: 28px;
      line-height: 32px;
      color: #42383e;
      margin: 0 0 24px 0;
    }
    
    .wunderkamer-content {
      font-family: 'Neue Haas Grotesk Display Pro', sans-serif;
      font-weight: 300;
      font-size: 16px;
      line-height: 24px;
      color: #888484;
      margin: 0 0 30px 0;
      flex: 1;
    }
    
    .wunderkamer-content p {
      margin: 0 0 16px 0;
    }
    
    .wunderkamer-content p:last-child {
      margin-bottom: 0;
    }
    
    /* Read More Button */
    .wunderkamer-button {
      display: flex;
      align-items: center;
      gap: 12px;
      text-decoration: none;
      cursor: pointer;
      transition: transform 0.3s ease;
      width: fit-content;
      margin-top: auto;
    }
    
    .wunderkamer-button:hover {
      transform: translateX(4px);
    }
    
    .wunderkamer-button span {
      font-family: 'Neue Haas Grotesk Display Pro', sans-serif;
      font-weight: 700;
      font-size: 16px;
      color: #ff40b4;
      white-space: nowrap;
    }
    
    .wunderkamer-button:hover span {
      text-decoration: underline;
    }
    
    .wunderkamer-button svg {
      color: #ff40b4;
      transition: transform 0.3s ease;
    }
    
    .wunderkamer-button:hover svg {
      transform: translateX(4px);
    }
    
    /* Responsive Design */
    @media (max-width: 1440px) {
      .wunderkamer-container {
        width: 95%;
        padding: 0 20px;
        height: auto;
      }
      .wunderkamer-image {
        left: 5%;
        width: 45%;
        height: clamp(300px, 35vw, 543px);
      }
      .wunderkamer-text-content {
        left: 55%;
        width: 40%;
        height: auto;
      }
    }
    
    @media (max-width: 768px) {
      .wunderkamer-image-text-section {
        min-height: auto;
        padding: 30px 0;
      }
      .wunderkamer-container {
        height: auto;
        display: flex;
        flex-direction: column;
        gap: 30px;
        padding: 0 20px;
      }
      .wunderkamer-image {
        position: relative;
        left: 0;
        top: 0;
        width: 100%;
        height: 300px;
      }
      .wunderkamer-text-content {
        position: relative;
        left: 0;
        top: 0;
        width: 100%;
        height: auto;
      }
      .wunderkamer-heading {
        font-size: 24px;
        line-height: 28px;
      }
      .wunderkamer-content {
        font-size: 14px;
        line-height: 20px;
      }
    }
    
    @media (max-width: 480px) {
      .wunderkamer-image {
        height: 250px;
      }
      .wunderkamer-heading {
        font-size: 20px;
        line-height: 24px;
      }
      .wunderkamer-content {
        font-size: 13px;
        line-height: 18px;
      }
    }
  </style>
  
  <div class="wunderkamer-container">
    {/* Left Image */}
    <div 
      class="wunderkamer-image"
      data-directus={setAttr({ collection: 'blocks', item: block.id, fields: 'image', mode: 'popover' })}
    >
      <img 
        src={block.image ? getImageUrl(block.image) : '/images/peter-bellerby-globes.png'}
        alt="Wunderkamer image"
        loading="lazy"
      />
    </div>
    
    {/* Right Text Content */}
    <div class="wunderkamer-text-content">
      <h2 
        class="wunderkamer-heading"
        data-directus={setAttr({ collection: 'blocks', item: block.id, fields: 'heading', mode: 'popover' })}
      >
        {heading || 'Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy'}
      </h2>
      
      <div 
        class="wunderkamer-content"
        data-directus={setAttr({ collection: 'blocks', item: block.id, fields: 'content', mode: 'popover' })}
        set:html={content || `
          <p>nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat. Duis autem vel eum iriure dolor Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>
          <p>Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat. nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat.</p>
        `}
      >
      </div>
      
      {/* Read More Button */}
      <a 
        href={block.button_link || '#'}
        class="wunderkamer-button"
        data-directus={setAttr({ collection: 'blocks', item: block.id, fields: ['button_text', 'button_link'], mode: 'popover' })}
      >
        <span>{buttonText || 'Read More'}</span>
        <svg 
          width="40" 
          height="14" 
          viewBox="0 0 40 14" 
          fill="none"
        >
          <path 
            d="M0 7H38M38 7L32 1M38 7L32 13" 
            stroke="currentColor" 
            strokeWidth="2" 
            strokeLinecap="round" 
            strokeLinejoin="round"
          />
        </svg>
      </a>
    </div>
  </div>
</section>